require(["handlebars"],function(b){var h=b.template({1:function(f,a,b,k,e){var d,c;return'\x3cdiv id\x3d"top-reviewed-properties-wrapper"\x3e\n    \x3cheader class\x3d"cols-row-header cf section-header no-group"\x3e\n        \x3ch3 id\x3d"top-reviewed-properties-header" class\x3d"section-header-main title"\x3e'+f.escapeExpression((c=null!=(c=b.title||(null!=a?a.title:a))?c:b.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"title",hash:{},data:e}):c))+'\x3c/h3\x3e\n    \x3c/header\x3e\n    \x3csection\n            class\x3d"uitk-carousel"\n            data-control\x3d"uitk-carousel"\n            id\x3d"top-reviewed-properties-carousel"\n    \x3e\n        \x3cdiv class\x3d"uitk-carousel-wrap"\x3e\n            \x3cdiv class\x3d"uitk-carousel-items uitk-grid all-grid-nowrap mobile-col-1-1 smalltablet-col-1-2 tablet-col-1-3 desktop-col-1-3 all-x-gutter-12 deals-optimization-tile-grid"\x3e\n'+(null!=(d=b.each.call(null!=a?a:{},null!=a?a.properties:a,{name:"each",hash:{},fn:f.program(2,e,0),inverse:f.noop,data:e}))?d:"")+"            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/section\x3e\n\x3c/div\x3e\n"},2:function(f,a,b,k,e){var d;return null!=(d=f.invokePartial(k["property-card"],a,{name:"property-card",data:e,indent:"                    ",helpers:b,partials:k,decorators:f.decorators}))?d:""},compiler:[7,"\x3e\x3d 4.0.0"],main:function(f,a,b,k,e){var d;return null!=(d=b["if"].call(null!=a?a:{},null!=(d=null!=a?a.properties:a)?d.length:d,{name:"if",hash:{},fn:f.program(1,e,0),inverse:f.noop,data:e}))?d:""},usePartial:!0,useData:!0});b.templates=b.templates||{};b.templates["properties-container"]=h;b.partials=b.partials||{};b.partials["properties-container"]=h});require(["handlebars"],function(b){var h=b.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(b,a,g,k,e){var d,c;return'\x3cdiv class\x3d"uitk-col uitk-carousel-item"\x3e\n    \x3ca href\x3d"'+b.escapeExpression((c=null!=(c=g.infositeURL||(null!=a?a.infositeURL:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"infositeURL",hash:{},data:e}):c))+'"\x3e\n        \x3cdiv class\x3d"flex-card no-outline" dataAttributes\x3d"track:storefront.topReviewedProperties.cardclick.'+b.escapeExpression((c=null!=(c=g.id||(null!=a?a.id:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"id",hash:{},data:e}):c))+'"\x3e\n            \x3cdiv class\x3d"flex-figure"\x3e\n                \x3cfigure\n                        class\x3d"image aspect-ratio16-9 loading"\n                        data-media-type\x3d"image"\n                        data-late\x3d"true"\n                        data-src\x3d"'+b.escapeExpression(b.lambda(null!=(d=null!=a?a.image:a)?d.url:d,a))+'"\n                        data-alt\x3d"alt text"\n                        data-aspect-ratio\x3d"16-9"\n                        data-class\x3d"tile-media"\n                \x3e\n                    \x3cspan class\x3d"media-loader"\x3e\n                      \x3cspan class\x3d"loader-primary loader-light loader-static loading" aria-hidden\x3d"true" title\x3d"Loading..."\x3e\x3c/span\x3e\n                    \x3c/span\x3e\n                \x3c/figure\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"flex-content"\x3e\n                \x3cdiv class\x3d"flex-area-primary"\x3e\n                    \x3ch3 class\x3d"property-name" title\x3d"'+b.escapeExpression((c=null!=(c=g.name||(null!=a?a.name:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"name",hash:{},data:e}):c))+'"\x3e\x3cstrong\x3e'+b.escapeExpression((c=null!=(c=g.name||(null!=a?a.name:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"name",hash:{},data:e}):c))+'\x3c/strong\x3e\x3c/h3\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"flex-content" id\x3d"property-information"\x3e\n                \x3cdiv class\x3d"flex-area-primary property-structure-type-and-reviews"\x3e\n                    \x3cdiv id\x3d"structure-type-information"\x3e\n                        \x3cspan class\x3d"property-structure-type"\x3e'+b.escapeExpression((c=null!=(c=g.structureTypeUpdated||(null!=a?a.structureTypeUpdated:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"structureTypeUpdated",hash:{},data:e}):c))+'\x3c/span\x3e\n                    \x3c/div\x3e\n                    \x3cdiv\x3e\n                        \x3cspan class\x3d"reviews-localized-score"\x3e\x3cstrong\x3e'+b.escapeExpression(b.lambda(null!=(d=null!=a?a.reviews:a)?d.localizedScore:d,a))+'/5\x3c/strong\x3e\x3c/span\x3e\n                        \x3cspan class\x3d"reviews-superlative"\x3e'+b.escapeExpression(b.lambda(null!=(d=null!=a?a.reviews:a)?d.superlative:d,a))+'\x3c/span\x3e\n                        \x3cspan class\x3d"reviews-totalAmount"\x3e'+b.escapeExpression((c=null!=(c=g.totalReviewCountLocalized||(null!=a?a.totalReviewCountLocalized:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"totalReviewCountLocalized",hash:{},data:e}):c))+'\x3c/span\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"flex-area-secondary"\x3e\n                    \x3ch3 class\x3d"property-price"\x3e\x3cstrong\x3e'+b.escapeExpression(b.lambda(null!=(d=null!=(d=null!=a?a.price:a)?d.lead:d)?d.formatted:d,a))+'\x3c/strong\x3e\x3c/h3\x3e\n                    \x3cspan class\x3d"per-night" id\x3d"pricing-rate"\x3e'+b.escapeExpression((c=null!=(c=g.pricingRate||(null!=a?a.pricingRate:a))?c:g.helperMissing,"function"===typeof c?c.call(null!=a?a:{},{name:"pricingRate",hash:{},data:e}):c))+"\x3c/span\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/a\x3e\n\x3c/div\x3e\n"},useData:!0});b.templates=b.templates||{};b.templates["property-card"]=h;b.partials=b.partials||{};b.partials["property-card"]=h});
define("TopReviewedProperties",["jquery","uitk","topReviewedProperties-loc","dctk/dctk"],function(b,h,f,a){return function(g){this.topReviewedPropertiesModel=g;this.getDestination=function(){if(localStorage&&localStorage.gcw_form_history){var a=JSON.parse(localStorage.gcw_form_history),b=a[this.topReviewedPropertiesModel.variables.context.locale];b||(b=a);if(b&&b["gcw-destination-region_id"]){this.topReviewedPropertiesModel.variables.destination={regionId:b["gcw-destination-region_id"]};return}}this.topReviewedPropertiesModel.variables.destination={regionId:this.topReviewedPropertiesModel.fallbackDestination};this.reportError("SF local storage form history no cached destination","sf.ls.fh.ncd")}.bind(this);this.fetchProperties=function(){b.ajax({method:"POST",url:"https://bex-api-loom.us-west-2.prod.expedia.com/graphql",data:JSON.stringify({operationName:null,variables:this.topReviewedPropertiesModel.variables,query:this.topReviewedPropertiesModel.query}),headers:{"Content-Type":"application/json","Client-Info":this.topReviewedPropertiesModel.clientInfo},timeout:1E4,error:this.fetchError,success:this.fetchSuccess})};this.fetchError=function(a,e,d){b("#top-reviewed-properties-container").remove();this.reportError("SF BEX-API property search query failure: "+d,"sf.ba.ps.qf")}.bind(this);this.fetchSuccess=function(a){a&&a.data&&a.data.propertySearch&&a.data.propertySearch.properties&&0<a.data.propertySearch.properties.length&&h.publish("topReviewedProperties.fetched",a.data.propertySearch);this.reportError("SF BEX-API property search no results","sf.ba.ps.nr")}.bind(this);this.filterProperties=function(a){for(var b=[],d=0;d<a.length;d++){var c=a[d];c.reviews&&c.reviews.total&&10<=c.reviews.total&&b.push(c)}if(6<=b.length)return b.slice(0,6);this.reportError("SF BEX-API property search inadequate results","sf.ba.ps.ir");return[]}.bind(this);this.adaptPropertyModels=function(a,b){return a.map(function(a){null!=a.structureType&&(a.structureTypeUpdated=f["storefrontProperties_"+a.structureType]);null!=a.reviews&&null!=a.reviews.localizedTotal&&(a.totalReviewCountLocalized=f.storefrontProperties_reviews.replace("{{totalReviewsCount}}",a.reviews.localizedTotal));a.pricingRate="";"TOTAL_RATE"===b?a.pricingRate=f.storefrontProperties_totalRate_multipleNights.replace("{{numberOfNights}}",3):"DAILY_RATE"===b&&(a.pricingRate=f.storefrontProperties_totalRate_singleNight);return a})};this.adaptTitle=function(a){return f.storefrontProperties_title.replace("{{city}}",a.split(" (")[0])};this.renderModule=function(k,e){if(k&&0<k.length){var d={properties:k,title:this.adaptTitle(e)},c=Handlebars.partials["properties-container"];b("#top-reviewed-properties-container").html(c(d));b("#top-reviewed-properties-carousel").uitk_carousel();a.onReady(function(){a.trackEvent({name:"Storefront top reviewed properties carousel visible",rfrr:"SF.TRPC.VIS"})})}else b("#top-reviewed-properties-container").remove()};this.reportError=function(b,e){if(a&&"function"===typeof a.onReady)a.onReady(function(){a.trackEvent({name:b,rfrr:e,trackVars:{prop36:e},microMessages:[b]})})}}});require(["TopReviewedProperties","topReviewedPropertiesModel","uitk"],function(b,h,f){if(h&&0!==Object.keys(h).length){var a=new b(h);a.getDestination();!(b=a.topReviewedPropertiesModel.variables.destination)||0>=parseInt(b.regionId,10)||(f.subscribe("topReviewedProperties.fetched",function(b,f){var e=a.filterProperties(f.properties);e=a.adaptPropertyModels(e,f&&f.summary&&f.summary.pricingScheme&&f.summary.pricingScheme.type||null);var d=f.summary;a.renderModule(e,d&&d.region&&d.region.shortName||null)}),a.fetchProperties())}});define("topReviewedProperties-loc",function(){return{storefrontProperties_APARTMENT:"Apartment",storefrontProperties_CABIN:"Cabin",storefrontProperties_CARAVAN_PARK:"Caravan park",storefrontProperties_CHALET:"Chalet",storefrontProperties_CONDO:"Condo",storefrontProperties_COTTAGE:"Cottage",storefrontProperties_HOUSE_BOAT:"House boat",storefrontProperties_RESIDENCE:"Residence",storefrontProperties_VACATION_HOME:"Vacation home",storefrontProperties_VILLA:"Villa",storefrontProperties_reviews:"({{totalReviewsCount}} reviews)",storefrontProperties_title:"Top reviewed homes and apartments in {{city}}",storefrontProperties_totalRate_multipleNights:"for {{numberOfNights}} nights",storefrontProperties_totalRate_singleNight:"for 1 night",storefrontProperties_nightlyRate:"per night"}});
//# sourceMappingURL=topReviewedProperties-1-en_US.js.map